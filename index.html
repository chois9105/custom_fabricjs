<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">

<link rel="stylesheet" type="text/css" href="./css/reset.css" />

<script src="./js/jquery-1.10.2.js"></script>
<script src="./js/fabric.js"></script>
<script src="./js/fabric.canvasex.js "></script>
<script src="./js/fabric.custom.js"></script>
<script src="./js/call.oembed.js"></script>

<title>image editor</title>


<script type="text/javascript">
$(function(){

// start init canvas(width, height) 
	var canvas = new fabric.CanvasEx('c');
	var customFabric = new CustomFabric();
	var editorWidth = $(".editor_wrapper").width();
	var editorHeight = $(".editor_wrapper").height();
	
	canvas.setWidth(editorWidth);
	canvas.setHeight(editorHeight);
	canvas.renderAll();


	customFabric.setCanvas(canvas);
	customFabric.resizeCanvas('#editorWrapper');

	
// end initCanvas 

	$("div.load_images .btn_loadimage").click(function(){

		var imageURL = $(".load_images .imageURL").val()
		customFabric
		.withURL(imageURL)
		.loadImage(function(data){

			fabric.Image.fromURL(data.thumbnail_url, function(oImg) {

				oImg.set({
					width: Math.round(editorWidth / 2),
					height: Math.round(editorHeight / 2),				
				});

				canvas.clear();
				canvas.add(oImg);	
				canvas.renderAll();
				oImg.center();				
				oImg.setCoords();
			});

		});

	});

	$(".btn_rotate").click(function(){
		customFabric.rotateObject(90);
	});

	
	$(".btn_rotateSymmentry").click(function(){
		customFabric.rotateSymmetry();		

	});

	$(".btn_upScale").click(function(){
		customFabric.upScale(0.2);		
	});

	$(".btn_downScale").click(function(){
		customFabric.downScale(-0.2);		
	});


	$(".btn_addCircle").click(function(){

		customFabric.addCircle({
			radius : 40,
			fill : 'black',
			width : 100,
			height : 100,
			top : 100,
			left : 100,
			opacity: 1,
			scaleX: 1,
			scaleY: 1,		
		});

	});

	$(".btn_addRect").click(function(){

		customFabric.addRect({
			fill : 'black',
			width : 100,
			height : 100,
			top : 100,
			left : 100,
			opacity: 1,
			scaleX: 1,
			scaleY: 1,		
		});

	});

	
	$(".btn_addTriangle").click(function(){

		customFabric.addTriangle({
			radius : 40,
			fill : 'black',
			width : 100,
			height : 100,
			top : 100,
			left : 100,
			opacity: 1,
			scaleX: 1,
			scaleY: 1,		
		});

	});


	$(".btn_img_croparea").click(function(){

		// imgObject must exist
		customFabric.showImgCropArea();

	});

	$(".btn_loadimage").click();



})


	

</script>

<style>
	.editor_wrapper {
		width : 80%;
		height: 512px;		
		border: 1px solid black
	}
	.photoButton {
		display: inline-block;		
		height: 20px;
		border: 1px solid red;
	}

</style>

</head>
<body>


<div class="iconWrap">

	<span class="photoButton btn_rotate">90도 회전</span>
	<span class="photoButton btn_rotateSymmentry">좌우대칭</span>
	
	<span class="photoButton btn_upScale">scaleUp(0.2)</span>
	<span class="photoButton btn_downScale">scaleDown(-0.2)</span>

	<span class="photoButton btn_addCircle">원형 만들기</span>
	<span class="photoButton btn_addRect">사각형 만들기</span>	
	<span class="photoButton btn_addTriangle">삼각형 만들기</span>


	<span class="photoButton btn_img_croparea">cropArea</span>





	<span class="photoButton btn_changeGrayscale"><input type="image" src="./images/btn/img_btnPhoto03_off.png" class="rollover" alt="왼쪽으로 90도 회전" title="왼쪽으로 90도 회전" /></span>
	<span class="pbtnBar photoButton"></span> 
	
	

	<span class="photoButton"><input type="image" src="./images/btn/img_btnPhoto04_off.png" id="crop_btn" class="rollover crop_btn" alt="오려내기" title="오려내기" /></span>
 	
	
	<span class="pbtnBar photoButton"></span>
	
	<span class="photoButton"><input type="image" src="./images/btn/img_btnPhoto07_off.png" class="rollover" alt="흑백으로 바꾸기" title="흑백으로 바꾸기" onclick='blackWhite()' /><input type="hidden" id="grayscale" value="color" /></span>	
	<span class="photoButton"><input type="image" src="./images/btn/img_btnPhoto06_off.png" class="rollover" alt="선명하게" title="선명하게" onclick='sharpen()' /><input type="hidden" id="sharpen" value="original"></span>
	
	<span class="pbtnBar photoButton"></span>
	
	<span class="photoButton"><input type="image" src="./images/btn/img_btnPhoto10_off.png" class="rollover" alt="밝게" title="밝게" onclick="upBrightness()" /></span>
	<span class="photoButton"><input type="image" src="./images/btn/img_btnPhoto11_off.png" class="rollover" alt="어둡게" title="어둡게" onclick="downBrightness()"/></span>
	

	<span class="pbtnBar photoButton"></span>
	
	<span class="photoButton"><input type="image" src="./images/btn/img_btnPhoto09_off.png" class="rollover" alt="축소" title="축소" onclick="zoom_out();" /></span>
	<span class="photoButton"><input type="image" src="./images/btn/img_btnPhoto08_off.png" class="rollover" alt="확대" title="확대" onclick="zoom_in();" /></span>
	<span class="photoButton">
		<select name="search-combo1" id="search-combo1" style="width:55px;">
	    	<option value="0.2">20%</option>
	        <option value="0.4">40%</option>
	        <option value="0.6">60%</option>
	        <option value="0.8">80%</option>
	        <option value="1" selected="selected">100%</option>
	        <option value="1.2">120%</option>
	        <option value="1.4">140%</option>
	        <option value="1.6">160%</option>
	        <option value="1.8">180%</option>
	        <option value="2">200%</option>
		 </select>	                       	 
	  </span>
	  
	  <span class="pbtnBar photoButton"></span>
	  <span class="photoButton"><input type="image" src="./images/btn/img_btnPhoto12_off.png" class="rollover undo_btn" alt="실행취소" title="실행취소" onclick="undo_work()"/></span>
	  <!-- 동작하지 않을 시,
	  <span class="photoButton"><img src="./images/btn/img_btnPhoto12_none.png" alt="실행취소" title="실행취소" /></span>-->
	  <span class="pbtnBar photoButton"></span>
      <span class="photoButton"><input type="image" src="./images/btn/img_btnPhoto13_off.png" class="rollover" alt="글자" title="글자" onclick="addText()"/></span>
      <span class="photoButton"><input type="image" src="./images/btn/img_btnPhoto14_off.png" class="rollover" alt="삭제" title="삭제" onclick="removeObject()"/></span>
      <span class="pbtnBar photoButton"></span>
      <div class="diagram">
      	<span class="photoButton"><input type="image" src="./images/btn/img_btnPhoto15_01_off.png" class="rollover" alt="도형" title="도형" onClick="toggleMenu()" /></span>
        <ul class="diagramul" id="diagram" style="display:none">
	      	<li onclick="addRect()" class="btnDiagram"><img src="./images/btn/img_btnPhoto15_1.png" title="사각형" class="dia"></li>
		    <li onclick="addCircle()" class="btnDiagram"><img src="./images/btn/img_btnPhoto15_2.png" title="원형" class="dia"></li>
		    <li onclick="addTriangle()" class="btnDiagram"><img src="./images/btn/img_btnPhoto15_3.png" title="삼각형" class="dia"></li>

	    <li onclick="startFreeDrawing()" id="btnDrawingMode" class="btnDiagram"><img src="./images/btn/img_btnPhoto15_5.png" title="자유형" class="dia"></li> 
	    </ul>
      </div>
	  <span class="pbtnBar photoButton">&nbsp;</span>

	  <span class="button btnTypeC" onclick="regen_work()"><a href="#">초기화</a></span>
	  <span class="button btnTypeC" id="btnViewOrigin" onclick="viewOriginal()"><a href="#">원화상보기</a></span>
	  
	  <span class="button btnTypeD fr mt2"><a href="#">저장</a></span>

</div>

<div class="load_images">
	<input value="http://www.youtube.com/watch?v=4Pax5vCQbMA" class="imageURL" />
	<button class="btn_loadimage">불러오기</button>

</div>


<div id="editorWrapper" class="editor_wrapper">
	<canvas id="c" style="position:absolute;margin: 0 0 0 0; padding:0; height:auto"></canvas> 
</div>

</body>

</html>